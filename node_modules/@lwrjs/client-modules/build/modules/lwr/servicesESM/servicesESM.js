import { registerHandleStaleModuleHook } from './handleStaleModuleESM';
import { getClientBootstrapConfig } from 'lwr/preInit';

const noop = () => {
  console.warn('API is not supported in ESM format');
};

function getAppMetadata() {
  const {
    appId,
    bootstrapModule,
    rootComponent,
    rootComponents
  } = getClientBootstrapConfig();
  return {
    appId,
    bootstrapModule,
    rootComponent,
    rootComponents
  };
}

export const services = {
  // addLoaderPlugin is only supported in AMD
  addLoaderPlugin: noop,
  handleStaleModule: registerHandleStaleModuleHook,
  appMetadata: getAppMetadata()
};